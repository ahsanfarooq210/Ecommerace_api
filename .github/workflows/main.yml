name: "ec2 test template"
on:
  push:
    branches:
      - "master"
jobs:
  build:
    name: "Build"
    runs-on: "ubuntu-latest"
    steps:
      - name: "remote ssh to EC2"
        uses: "appleboy/ssh-action@master"
        with:
          host: "${{secrets.HOST_DNS}}"
          username: "${{secrets.USERNAME}}"
          key: "${{secrets.EC2_SSH_KEY}}"
          script: ". ./pipeline-testing-keypair.sh\ncd ~/\npm2 delete \npm2 save\ngit checkout main\ngit pull origin main\nnpm i\nnpm run start\npm2 start npm --name \"\" -- start\n"
